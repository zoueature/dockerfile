FROM golang:1.21.4

COPY ./yq_linux_amd64 /usr/bin/yq

ENV GOPRIVATE="gitlab.jiebu.com"
ENV GOINSECURE="gitlab.jiebu.com"
ENV GOPROXY='https://goproxy.cn,direct'

RUN mkdir -p /root/.ssh
COPY ./rsa /root/.ssh/id_rsa
RUN chmod 400 /root/.ssh/id_rsa
COPY ./known_hosts /root/.ssh

RUN git config --global url."git@gitlab.jiebu.com:".insteadOf "http://gitlab.jiebu.com/"